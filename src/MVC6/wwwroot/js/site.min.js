var parseThumbnailElements=function(e){for(var t=e.childNodes,i=t.length,o=[],r=0;i>r;r++)parseElement(t[r],o);return o},closest=function e(t,i){return t&&(i(t)?t:e(t.parentNode,i))},openPhotoSwipe=function(e,t,i,o){var r,a,n,l=document.querySelectorAll(".pswp")[0];if(n=parseThumbnailElements(t),a={galleryUID:t.getAttribute("data-pswp-uid"),getThumbBoundsFn:function(e){var t=n[e].el.getElementsByTagName("img")[0],i=window.pageYOffset||document.documentElement.scrollTop,o=t.getBoundingClientRect();return{x:o.left,y:o.top+i,w:o.width}}},o)if(a.galleryPIDs){for(var s=0;s<n.length;s++)if(n[s].pid==e){a.index=s;break}}else a.index=parseInt(e,10)-1;else a.index=parseInt(e,10);return isNaN(a.index)?void 0:(i&&(a.showAnimationDuration=0),r=new PhotoSwipe(l,PhotoSwipeUI_Default,n,a),r.init(),r())},onThumbnailsClick=function(e){e=e||window.event,e.preventDefault?e.preventDefault():e.returnValue=!1;var t=e.target||e.srcElement,i=closest(t,function(e){return e.tagName&&"FIGURE"===e.tagName.toUpperCase()});if(i){for(var o,r=i.parentNode,a=i.parentNode.childNodes,n=a.length,l=0,s=0;n>s;s++)if(1===a[s].nodeType){if(a[s]===i){o=l;break}l++}return o>=0&&openPhotoSwipe(o,r,null,null),!1}},parseElement=function(e,t){var i,o,r;1===e.nodeType&&(i=e.children[0],o=i.getAttribute("data-size").split("x"),r={src:i.getAttribute("href"),w:parseInt(o[0],10),h:parseInt(o[1],10)},e.children.length>1&&(r.title=e.children[1].innerHTML),i.children.length>0&&(r.msrc=i.children[0].getAttribute("src")),r.el=e,t.push(r))},initPhotoSwipeFromDOM=function(e){for(var t=function(){var e=window.location.hash.substring(1),t={};if(e.length<5)return t;for(var i=e.split("&"),o=0;o<i.length;o++)if(i[o]){var r=i[o].split("=");r.length<2||(t[r[0]]=r[1])}return t.gid&&(t.gid=parseInt(t.gid,10)),t},i=document.querySelectorAll(e),o=0,r=i.length;r>o;o++)i[o].setAttribute("data-pswp-uid",(o+1).toString()),i[o].onclick=onThumbnailsClick;var a=t();return a.pid&&a.gid?openPhotoSwipe(a.pid,i[a.gid-1],!0,!0):void 0},gallery=initPhotoSwipeFromDOM(".my-gallery"),PhotoSwipeLoad;!function(e){var t=function(){function e(e,t,i){var o=this;this.gid=e,this.galleryOptions=t,this.callback=i,this.EphotoGalleryPhotoSizes={240:"m",320:"n",640:"z",800:"c",1024:"b",1600:"h",2048:"k",2400:"o"},this.currentSize=parseInt(Object.keys(this.EphotoGalleryPhotoSizes)[0],10),this.firstResize=!0,this.initGalleryWithCallback=function(e){return e=e||function(){},o.EphotoGalleryData&&o.galleryOptions?(o.gallery||o.initGallery(o.EphotoGalleryData,o.galleryOptions),void e(o.gallery)):"You have to initialize everything."},this.loadMoreCallback=function(e){e.preventDefault(),e.stopPropagation();var t=$("#loadMore"),i=$("#moreContent"),r=t.get(0).href,a=i.prev();$.get(r,function(e){i.replaceWith(e)}).then(function(e,t,i){var r=((o.gallery?o.gallery.items:o.EphotoGalleryData)||[]).length;for(a=0==a.length?$(".my-gallery").children().first():a.next();void 0!=a.get(0);a=a.next()){var n=o,l=a.children("a");l.on("click",function(e){e.preventDefault(),e.stopPropagation();var t=this.parentNode.attributes.getNamedItem("data-pswp-uid").value;n.gallery||(n.galleryOptions.index=t,n.initGallery(n.EphotoGalleryData,n.galleryOptions),n.callback(n.gallery)),n.gallery.invalidateCurrItems(),n.gallery.goTo(parseInt(t))});var s=l.data("size");if(s){a.attr("data-pswp-uid",r++);var p,h,c=l.data("size").split("x"),u=parseFloat(c[1])/parseFloat(c[0]),d={src:"",w:0,h:0,sizeData:{}},g=o.EphotoGalleryPhotoSizes;for(p in g){h=g[p];var f=l.children("img").get(0),y=1>=u?parseFloat(p):parseFloat(p)*u,v=u>1?parseFloat(p):parseFloat(p)*u;d.sizeData[h]={src:f.src.replace("m_",h+"_"),w:y,h:v},d.original_src=l.get(0).href.replace("o_","")}o.EphotoGalleryData.push(d)}}$("#loadMore").on("click",o.loadMoreCallback)})},this.initGallery=function(e,t){var i=document.querySelectorAll(".pswp")[0],r=new PhotoSwipe(i,PhotoSwipeUI_Default,e,t);r.listen("beforeResize",function(){var e=0,t=!1,i=r.viewportSize.x*window.devicePixelRatio;for(var a in o.EphotoGalleryPhotoSizes)i>a&&(e=parseInt(a,10));o.currentSize<e&&(t=!0,o.currentSize=e),t&&!o.firstResize&&r.invalidateCurrItems(),o.firstResize=!1}),r.listen("gettingData",function(e,t){var i=o.EphotoGalleryPhotoSizes[o.currentSize];t.src=t.sizeData[i].src||t.o.src,t.w=t.sizeData[i].w||t.o.w,t.h=t.sizeData[i].h||t.o.h}),r.listen("destroy",function(){o.gallery=void 0}),o.gallery=r},this.init=function(){o.galleryOptions=o.galleryOptions||{},"getImageURLForShare"in o.galleryOptions||(o.galleryOptions.getImageURLForShare=function(e){return this.gallery.currItem.original_src||this.gallery.currItem.src||""}),o.callback=o.callback||function(){},$("#loadMore").on("click",o.loadMoreCallback),o.EphotoGalleryData||(o.EphotoGalleryData=[],$("#loadMore").click())},this.init()}return e}();e.PhotoSwipeLoad=t}(PhotoSwipeLoad||(PhotoSwipeLoad={}));var PhotoSwipeRun;!function(e){var t=function(){function e(){this.onload=function(){var e,t=[],i=document.URL.split("#")[1];if(void 0!=i)for(var o=i.split("&"),r=0;r<o.length;r++)e=o[r].split("="),t.push(e[1]),t[e[0]]=e[1];{var a=t.gid?t.gid:"1",n={index:0,counterEl:!1},l=function(e){e.init()};new PhotoSwipeLoad.PhotoSwipeLoad(a,n,l)}},"loading"!=document.readyState?this.onload():document.addEventListener("DOMContentLoaded",this.onload)}return e}();e.PhotoSwipeRun=t}(PhotoSwipeRun||(PhotoSwipeRun={})),new PhotoSwipeRun.PhotoSwipeRun;